(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function p(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(e){if(e.ep)return;e.ep=!0;const t=p(e);fetch(e.href,t)}})();const v={ps1:{available:45,total:50,spots:Array.from({length:50},(n,o)=>({id:`PS1-${o+1}`,status:o<45?"available":"occupied",occupiedUntil:null}))},b:{available:0,total:30,spots:Array.from({length:30},(n,o)=>({id:`B-${o+1}`,status:"occupied",occupiedUntil:null}))},c:{available:5,total:40,spots:Array.from({length:40},(n,o)=>({id:`C-${o+1}`,status:o<5?"available":"occupied",occupiedUntil:null}))},f:{available:20,total:35,spots:Array.from({length:35},(n,o)=>({id:`F-${o+1}`,status:o<20?"available":"occupied",occupiedUntil:null}))}};function g(n){const o=document.createElement("div");o.className="notification-popup",o.innerHTML=`
        <div class="notification-content">
            <p>${n}</p>
            <button class="close-notification">âœ•</button>
        </div>
    `,document.body.appendChild(o),o.querySelector(".close-notification").addEventListener("click",()=>o.remove()),setTimeout(()=>{o.style.animation="slideIn 0.5s ease-out reverse",setTimeout(()=>o.remove(),500)},5e3);const a=document.querySelector(".notification-list"),e=document.createElement("div");e.style.padding="1rem",e.style.borderBottom="1px solid #ddd",e.textContent=n,a.prepend(e)}function C(n,o,p,a){const e=o[n];if(!e)return;const t=document.createElement("div");t.className="modal",t.style.display="block";const i=document.createElement("div");i.className="modal-content",i.style.maxWidth="800px";const m=document.createElement("h2");m.textContent=`Lot ${n.toUpperCase()} - Spots Overview`,i.appendChild(m);const u=document.createElement("div");u.style.display="grid",u.style.gridTemplateColumns="repeat(auto-fill, minmax(100px, 1fr))",u.style.gap="10px",u.style.marginTop="20px",e.spots.forEach((l,d)=>{const r=document.createElement("div");r.className=`spot-card ${l.status}`,r.style.padding="10px",r.style.borderRadius="4px",r.style.textAlign="center",r.style.backgroundColor=l.status==="available"?"#d4edda":l.status==="reserved"?"#fff3cd":"#f8d7da";let c=`
            <div>${l.id}</div>
            <div>${l.status}</div>
            ${l.occupiedUntil?`<div>Until: ${l.occupiedUntil}</div>`:""}
        `;p&&l.userId===p.studentId&&(c+=`
                <button class="vacate-btn" style="margin-top: 8px; font-size: 0.9rem;">
                    Vacate Spot
                </button>
            `),r.innerHTML=c;const f=r.querySelector(".vacate-btn");f&&f.addEventListener("click",y=>{y.stopPropagation(),a(n,d),t.remove()}),u.appendChild(r)}),i.appendChild(u);const s=document.createElement("button");s.textContent="Close",s.style.marginTop="20px",s.onclick=()=>t.remove(),i.appendChild(s),t.appendChild(i),document.body.appendChild(t),t.onclick=l=>{l.target===t&&t.remove()}}function S(n,o,p,a,e){let t=null,i=JSON.parse(localStorage.getItem("users"))||[];function m(d,r){const c=i.find(f=>f.studentId===d&&f.password===r);return c?(t=c,c):null}function u(d,r,c){if(i.some(y=>y.studentId===d))return{error:"Student ID already registered!"};const f={studentId:d,name:r,password:c};return i.push(f),localStorage.setItem("users",JSON.stringify(i)),t=f,{user:f}}function s(){return t}function l(){t=null}return{login:m,register:u,getCurrentUser:s,logout:l}}function E(n,o,p){function a(){o(),p(n),localStorage.setItem("parkingData",JSON.stringify(n))}function e(s,l,d){if(!d)return{error:"Please login first"};if(n[s]&&n[s].available>0){n[s].available--;const r=n[s].spots.findIndex(c=>c.status==="available");return r!==-1&&(n[s].spots[r].status="occupied",n[s].spots[r].occupiedUntil=l,n[s].spots[r].userId=d.studentId),a(),{success:`Parking registered in ${s.toUpperCase()} until ${l}`}}return{error:`Sorry, lot ${s.toUpperCase()} is currently full.`}}function t(s,l,d){if(!d)return{error:"Please login first"};if(n[s]&&n[s].available>0){n[s].available--;const r=n[s].spots.findIndex(c=>c.status==="available");return r!==-1&&(n[s].spots[r].status="reserved",n[s].spots[r].occupiedUntil=l,n[s].spots[r].userId=d.studentId),a(),{success:`Spot reserved in ${s.toUpperCase()} for ${l}`}}return{error:`No spots available in lot ${s.toUpperCase()} for the requested time.`}}function i(s,l,d){if(!d)return{error:"Please login first"};const r=n[s];if(!r)return{error:"Invalid lot selected"};const c=r.spots[l];return c?c.userId!==d.studentId?{error:"You can only vacate spots registered to you"}:(c.status="available",c.occupiedUntil=null,c.userId=null,r.available++,a(),{success:`Spot ${l+1} in lot ${s.toUpperCase()} has been marked as available`}):{error:"Invalid spot selected"}}function m(s){if(!s)return[];const l=[];return Object.entries(n).forEach(([d,r])=>{r.spots.forEach((c,f)=>{c.userId===s.studentId&&l.push({lot:d,spotId:f,spotNumber:f+1,status:c.status,occupiedUntil:c.occupiedUntil})})}),l}const u=localStorage.getItem("parkingData");return u&&Object.assign(n,JSON.parse(u)),{parkVehicle:e,reserveSpot:t,vacateSpot:i,getUserSpots:m}}function x(n){function o(){document.querySelectorAll('select[name="lotSelect"]').forEach(e=>{const t=e.value;for(;e.options.length>1;)e.remove(1);Object.entries(n).forEach(([i,m])=>{if(m.available>0){const u=new Option(`${i.toUpperCase()} (${m.available} spots)`,i);e.add(u)}}),[...e.options].some(i=>i.value===t)?e.value=t:e.selectedIndex=0})}function p(a,e,t){e.style.display="none",t.style.display="none";const i=document.getElementById("userInfo"),m=document.createElement("span");m.textContent=`Welcome, ${a.name}`,m.style.color="white",m.style.marginRight="1rem";const u=document.createElement("button");return u.textContent="Logout",i.innerHTML="",i.appendChild(m),i.appendChild(u),u}return{updateLotSelections:o,updateUserInfo:p}}function h(n){document.querySelectorAll(".lot-card").forEach(p=>{const a=p.querySelector("h3").textContent.split(" ")[1].toLowerCase(),e=p.querySelector(".status"),t=n[a];t&&(t.available===0?(e.textContent="Full",e.className="status full"):t.available<=5?(e.textContent=`Limited: ${t.available}`,e.className="status limited"):(e.textContent=`Available: ${t.available}`,e.className="status available"))})}document.getElementById("loginBtn");document.getElementById("registerBtn");document.getElementById("loginModal");document.getElementById("registerModal");document.getElementById("loginForm");document.getElementById("registerForm");document.getElementById("parkForm");document.getElementById("reserveForm");document.getElementById("switchToRegister");document.getElementById("switchToLogin");const I=x(v),b=S(),U=E(v,I.updateLotSelections,h);I.updateLotSelections();h(v);document.querySelectorAll(".view-spots-btn").forEach(n=>{n.addEventListener("click",function(){const o=this.closest(".lot-card").querySelector("h3").textContent.split(" ")[1].toLowerCase();C(o,v,b.getCurrentUser(),(p,a)=>{const e=U.vacateSpot(p,a,b.getCurrentUser());e.error?g(e.error):g(e.success)})})});
